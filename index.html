<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WYSIWYG Editor</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f0f0f0;
        margin: 0;
        padding: 0;
      }

      .editor-container {
        background-color: #ffffff;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        height: 100vh;
      }

      .toolbar {
        display: flex;
        padding: 10px;
        background-color: #f3f2f1;
        border-bottom: 1px solid #e1dfdd;
      }

      .toolbar-group {
        display: flex;
        align-items: center;
        margin-right: 15px;
      }

      .toolbar select {
        padding: 4px 8px;
        border: 1px solid #c8c6c4;
        border-radius: 2px;
        outline: none;
        font-size: 14px;
        background-color: white;
        margin-right: 5px;
      }

      .toolbar button {
        padding: 6px 10px;
        border: 1px solid transparent;
        background-color: transparent;
        color: #323130;
        font-size: 14px;
        cursor: pointer;
        border-radius: 2px;
        margin-right: 2px;
      }

      .toolbar button:hover {
        background-color: #edebe9;
        border-color: #c8c6c4;
      }

      .toolbar button.active {
        background-color: #c7e0f4;
        border-color: #0078d4;
      }

      .editor-wrapper {
        display: flex;
        flex-grow: 1;
        overflow: hidden;
      }

      .editor {
        flex-grow: 1;
        padding: 20px;
        border: none;
        outline: none;
        font-size: 16px;
        line-height: 1.5;
        overflow-y: auto;
      }

      .html-editor {
        flex-grow: 1;
        padding: 20px;
        border: none;
        outline: none;
        font-size: 14px;
        font-family: "Courier New", Courier, monospace;
        background-color: #1e1e1e;
        color: #d4d4d4;
        display: none;
        resize: none;
      }

      .color-picker {
        display: flex;
        align-items: center;
      }

      .color-preview {
        width: 20px;
        height: 20px;
        border: 1px solid #c8c6c4;
        margin-right: 5px;
        cursor: pointer;
      }

      input[type="color"] {
        width: 30px;
        height: 30px;
        padding: 0;
        border: none;
        cursor: pointer;
      }
      .image-upload-area {
        border: 2px dashed #ccc;
        border-radius: 5px;
        padding: 20px;
        text-align: center;
        margin-top: 10px;
        display: none;
      }

      .image-upload-area.drag-over {
        background-color: #f0f0f0;
      }

      #imageUpload {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="editor-container">
      <div class="toolbar">
        <div class="toolbar-group">
          <select id="fontName">
            <option value="Arial">Arial</option>
            <option value="Helvetica">Helvetica</option>
            <option value="Times New Roman">Times New Roman</option>
            <option value="Courier New">Courier New</option>
          </select>
          <select id="fontSize">
            <option value="1">8</option>
            <option value="2">10</option>
            <option value="3">12</option>
            <option value="4">14</option>
            <option value="5" selected>16</option>
            <option value="6">18</option>
            <option value="7">24</option>
          </select>
        </div>
        <div class="toolbar-group">
          <button id="bold" title="Bold"><b>B</b></button>
          <button id="italic" title="Italic"><i>I</i></button>
          <button id="underline" title="Underline"><u>U</u></button>
        </div>
        <div class="toolbar-group">
          <div class="color-picker">
            <input
              type="color"
              id="fontColor"
              value="#000000"
              title="Font Color"
            />
          </div>
          <div class="color-picker">
            <input
              type="color"
              id="bgColor"
              value="#ffffff"
              title="Background Color"
            />
          </div>
        </div>
        <div class="toolbar-group">
          <button id="alignLeft" title="Align Left">&#8592;</button>
          <button id="alignCenter" title="Align Center">=</button>
          <button id="alignRight" title="Align Right">&#8594;</button>
          <button id="justify" title="Justify">&#8596;</button>
        </div>
        <div class="toolbar-group">
          <button id="insertOrderedList" title="Ordered List">OL</button>
          <button id="insertUnorderedList" title="Unordered List">UL</button>
        </div>
        <div class="toolbar-group">
          <button id="toggleHtml" title="Toggle HTML">HTML</button>
        </div>
        <div class="toolbar-group">
          <button id="insertImage" title="Insert Image">IMG</button>
          <button id="insertLink" title="Insert Link">LINK</button>
        </div>
      </div>
      <div class="editor-wrapper">
        <div id="editor" class="editor" contenteditable="true">
          Start editing here...
        </div>
        <textarea id="htmlEditor" class="html-editor"></textarea>
      </div>
      <div id="imageUploadArea" class="image-upload-area">
        <p>Drag & drop an image here or click to select</p>
        <input type="file" id="imageUpload" accept="image/*" />
      </div>
    </div>

    <script>
      const editor = document.getElementById("editor");
      const htmlEditor = document.getElementById("htmlEditor");
      const fontNameSelect = document.getElementById("fontName");
      const fontSizeSelect = document.getElementById("fontSize");
      const boldButton = document.getElementById("bold");
      const italicButton = document.getElementById("italic");
      const underlineButton = document.getElementById("underline");
      const fontColorInput = document.getElementById("fontColor");
      const bgColorInput = document.getElementById("bgColor");
      const alignLeftButton = document.getElementById("alignLeft");
      const alignCenterButton = document.getElementById("alignCenter");
      const alignRightButton = document.getElementById("alignRight");
      const justifyButton = document.getElementById("justify");
      const insertOrderedListButton =
        document.getElementById("insertOrderedList");
      const insertUnorderedListButton = document.getElementById(
        "insertUnorderedList"
      );
      const toggleHtmlButton = document.getElementById("toggleHtml");

      function execCommandWithArg(command, arg) {
        document.execCommand(command, false, arg);
      }

      fontNameSelect.addEventListener("change", () =>
        execCommandWithArg("fontName", fontNameSelect.value)
      );
      fontSizeSelect.addEventListener("change", () =>
        execCommandWithArg("fontSize", fontSizeSelect.value)
      );

      boldButton.addEventListener("click", () =>
        document.execCommand("bold", false)
      );
      italicButton.addEventListener("click", () =>
        document.execCommand("italic", false)
      );
      underlineButton.addEventListener("click", () =>
        document.execCommand("underline", false)
      );

      fontColorInput.addEventListener("input", function () {
        execCommandWithArg("foreColor", this.value);
      });

      bgColorInput.addEventListener("input", function () {
        execCommandWithArg("hiliteColor", this.value);
      });

      alignLeftButton.addEventListener("click", () =>
        document.execCommand("justifyLeft", false)
      );
      alignCenterButton.addEventListener("click", () =>
        document.execCommand("justifyCenter", false)
      );
      alignRightButton.addEventListener("click", () =>
        document.execCommand("justifyRight", false)
      );
      justifyButton.addEventListener("click", () =>
        document.execCommand("justifyFull", false)
      );

      insertOrderedListButton.addEventListener("click", () =>
        document.execCommand("insertOrderedList", false)
      );
      insertUnorderedListButton.addEventListener("click", () =>
        document.execCommand("insertUnorderedList", false)
      );

      toggleHtmlButton.addEventListener("click", () => {
        if (editor.style.display !== "none") {
          htmlEditor.value = editor.innerHTML;
          editor.style.display = "none";
          htmlEditor.style.display = "block";
        } else {
          editor.innerHTML = htmlEditor.value;
          editor.style.display = "block";
          htmlEditor.style.display = "none";
        }
      });

      document.addEventListener("selectionchange", () => {
        boldButton.classList.toggle(
          "active",
          document.queryCommandState("bold")
        );
        italicButton.classList.toggle(
          "active",
          document.queryCommandState("italic")
        );
        underlineButton.classList.toggle(
          "active",
          document.queryCommandState("underline")
        );
        alignLeftButton.classList.toggle(
          "active",
          document.queryCommandState("justifyLeft")
        );
        alignCenterButton.classList.toggle(
          "active",
          document.queryCommandState("justifyCenter")
        );
        alignRightButton.classList.toggle(
          "active",
          document.queryCommandState("justifyRight")
        );
        justifyButton.classList.toggle(
          "active",
          document.queryCommandState("justifyFull")
        );
      });

      const insertImageButton = document.getElementById("insertImage");
      const insertLinkButton = document.getElementById("insertLink");
      const imageUploadArea = document.getElementById("imageUploadArea");
      const imageUpload = document.getElementById("imageUpload");

      insertImageButton.addEventListener("click", () => {
        imageUploadArea.style.display =
          imageUploadArea.style.display === "none" ? "block" : "none";
      });

      insertLinkButton.addEventListener("click", () => {
        const url = prompt("Enter the URL:");
        if (url) {
          document.execCommand("createLink", false, url);
        }
      });

      imageUploadArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        imageUploadArea.classList.add("drag-over");
      });

      imageUploadArea.addEventListener("dragleave", () => {
        imageUploadArea.classList.remove("drag-over");
      });

      imageUploadArea.addEventListener("drop", (e) => {
        e.preventDefault();
        imageUploadArea.classList.remove("drag-over");
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          handleImageUpload(files[0]);
        }
      });

      imageUploadArea.addEventListener("click", () => {
        imageUpload.click();
      });

      imageUpload.addEventListener("change", (e) => {
        if (e.target.files.length > 0) {
          handleImageUpload(e.target.files[0]);
        }
      });

      function handleImageUpload(file) {
        if (file.type.startsWith("image/")) {
          const reader = new FileReader();
          reader.onload = (e) => {
            const img = document.createElement("img");
            img.src = e.target.result;
            img.style.maxWidth = "100%";
            editor.focus();
            document.execCommand("insertHTML", false, img.outerHTML);
            imageUploadArea.style.display = "none";
          };
          reader.readAsDataURL(file);
        } else {
          alert("Please select an image file.");
        }
      }

      document.addEventListener("selectionchange", () => {
        const selection = window.getSelection();
        if (selection.rangeCount > 0) {
          const range = selection.getRangeAt(0);
          const linkNode = range.commonAncestorContainer.parentNode;
          insertLinkButton.classList.toggle(
            "active",
            linkNode.nodeName === "A"
          );
        }
      });
    </script>
  </body>
</html>
